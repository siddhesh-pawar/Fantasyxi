<!-- profile.html -->
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Profile - Fantasy 11 Predictor</title>
    <link rel="stylesheet" href="/static/style1.css">
    <link rel="stylesheet" href="/static/auth.css">
    <link rel="icon" href="/static/images/favicon.ico" type="image/x-icon">
</head>
<body>
    <nav class="navbar">
        <div class="nav-container">
            <div class="logo">
                <img src="/static/images/ipl3.png" alt="Fantasy11 Logo" class="logo-img">
                <span>Fantasy11</span>
            </div>
            <div class="nav-links">
                <a href="{{ url_for('home') }}">Home</a>
                <a href="{{ url_for('profile') }}" class="active">Profile</a>
                <a href="{{ url_for('logout') }}" class="nav-cta">Logout</a>
            </div>
        </div>
    </nav>

    <div class="profile-container">
        <div class="profile-card">
            <div class="profile-header">
                <h2>My Profile</h2>
                <p>Welcome, {{ user.username }}!</p>
            </div>

            <!-- Flash Messages -->
            {% with messages = get_flashed_messages(with_categories=true) %}
                {% if messages %}
                    {% for category, message in messages %}
                        <div class="alert alert-{{ category }}">
                            {{ message }}
                        </div>
                    {% endfor %}
                {% endif %}
            {% endwith %}

            <!-- Profile Information -->
            <div class="profile-section">
                <h3>Account Information</h3>
                <div class="info-grid">
                    <div class="info-item">
                        <label>Username:</label>
                        <span>{{ user.username }}</span>
                    </div>
                    <div class="info-item">
                        <label>Email:</label>
                        <span>{{ user.email }}</span>
                    </div>
                    <div class="info-item">
                        <label>Member Since:</label>
                        <span>{{ user.created_at.strftime('%B %d, %Y') }}</span>
                    </div>
                    <div class="info-item">
                        <label>Total Predictions:</label>
                        <span>{{ user.predictions_count or 0 }}</span>
                    </div>
                    <div class="info-item">
                        <label>Favorite Team:</label>
                        <span>{{ user.favorite_team or 'Not set' }}</span>
                    </div>
                </div>
            </div>

            <!-- Update Profile Form -->
            <div class="profile-section">
                <h3>Update Profile</h3>
                <form method="POST" action="{{ url_for('update_profile') }}" class="profile-form">
                    <div class="form-group">
                        <label for="email">Email Address</label>
                        <input type="email" id="email" name="email" value="{{ user.email }}" required>
                    </div>
                    <div class="form-group">
                        <label for="favorite_team">Favorite Team</label>
                        <select id="favorite_team" name="favorite_team">
                            <option value="">Select a team</option>
                            <option value="Chennai Super Kings" {% if user.favorite_team == 'Chennai Super Kings' %}selected{% endif %}>Chennai Super Kings</option>
                            <option value="Delhi Capitals" {% if user.favorite_team == 'Delhi Capitals' %}selected{% endif %}>Delhi Capitals</option>
                            <option value="Gujarat Titans" {% if user.favorite_team == 'Gujarat Titans' %}selected{% endif %}>Gujarat Titans</option>
                            <option value="Kolkata Knight Riders" {% if user.favorite_team == 'Kolkata Knight Riders' %}selected{% endif %}>Kolkata Knight Riders</option>
                            <option value="Lucknow Super Giants" {% if user.favorite_team == 'Lucknow Super Giants' %}selected{% endif %}>Lucknow Super Giants</option>
                            <option value="Mumbai Indians" {% if user.favorite_team == 'Mumbai Indians' %}selected{% endif %}>Mumbai Indians</option>
                            <option value="Punjab Kings" {% if user.favorite_team == 'Punjab Kings' %}selected{% endif %}>Punjab Kings</option>
                            <option value="Rajasthan Royals" {% if user.favorite_team == 'Rajasthan Royals' %}selected{% endif %}>Rajasthan Royals</option>
                            <option value="Royal Challengers Bengaluru" {% if user.favorite_team == 'Royal Challengers Bengaluru' %}selected{% endif %}>Royal Challengers Bengaluru</option>
                            <option value="Sunrisers Hyderabad" {% if user.favorite_team == 'Sunrisers Hyderabad' %}selected{% endif %}>Sunrisers Hyderabad</option>
                        </select>
                    </div>
                    <button type="submit" class="auth-btn">Update Profile</button>
                </form>
            </div>

            <!-- Change Password Form -->
            <div class="profile-section">
                <h3>Change Password</h3>
                <form method="POST" action="{{ url_for('change_password') }}" class="profile-form">
                    <div class="form-group">
                        <label for="current_password">Current Password</label>
                        <input type="password" id="current_password" name="current_password" required>
                    </div>
                    <div class="form-group">
                        <label for="new_password">New Password</label>
                        <input type="password" id="new_password" name="new_password" required>
                    </div>
                    <div class="form-group">
                        <label for="confirm_new_password">Confirm New Password</label>
                        <input type="password" id="confirm_new_password" name="confirm_new_password" required>
                    </div>
                    <button type="submit" class="auth-btn">Change Password</button>
                </form>
            </div>

            <!-- Recent Predictions -->
            {% if predictions %}
            <div class="profile-section">
                <h3>Recent Predictions</h3>
                <div class="predictions-list">
                    {% for prediction in predictions %}
                    <div class="prediction-item">
                        <span class="prediction-match">{{ prediction.team1 }} vs {{ prediction.team2 }}</span>
                        <span class="prediction-date">{{ prediction.created_at.strftime('%b %d, %Y at %I:%M %p') }}</span>
                    </div>
                    {% endfor %}
                </div>
            </div>
            {% endif %}
        </div>
    </div>
</body>
</html>